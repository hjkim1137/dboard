<div class="nav">
  <div><a href="/"><img src="/homelogo.png" class="logo" ></a></div>
  <div class="navDetail">
    <a href="/list"><img src="/feed.png" class="navIcon"><div>피드</div></a>
    <a href="/write"><img src="/edit.png" class="navIcon"><div>작성</div></a>
    <a href="/chat/list"><img src="/chat.png" class="navIcon"><div>대화</div></a>
  </div>
  

  <% if(currentUser) { %>
  <div class="profileBox">
    <button class="toggle">다크모드로 🌙</button>
    <a href="/logout"><div>로그아웃</div></a>

    <button class="profileInner" onclick="location.href='/mypage'">
      <% if(currentUser.img) { %>
         <img class="navProfile" src="<%= currentUser.img %>"></img>
          <p><strong><%= currentUser.username %></strong></p>
      <% } else { %>
          <img class="navProfile" src="/profile.png"></img>
          <p><strong><%= currentUser.username %></strong></p>
      <% } %>
    </button>
  </div>

  <% } else { %>
    <div class="profileBox">
      <button class="toggle">다크모드로 🌙</button>
      <a href="/login" class="navLoginRegister"><div>로그인</div></a>
      <a href="/register" class="navLoginRegister"><div>회원가입</div></a>
    </div>
  <% } %> 
</div>

<script>
let mode = localStorage.getItem('mode');
let toggle = document.querySelector('.toggle');
let body = document.querySelector('body');
let navIcons = document.querySelectorAll(".navIcon")

// 화면 이동시에도 다크모드 유지
if (mode === 'dark') {
  toggle.innerHTML = '일반모드로 ☀️';
  body.classList.remove('grey-bg');
  body.classList.add('dark-mode');

  navIcons[0].src="/feed2.png"
  navIcons[1].src="/edit2.png"
  navIcons[2].src="/chat2.png"

} else {
  toggle.innerHTML = '다크모드로 🌙';
  body.classList.remove('dark-mode');

  navIcons[0].src="/feed.png"
  navIcons[1].src="/edit.png"
  navIcons[2].src="/chat.png"
}

// 다크모드 버튼 눌렀을 때
toggle.addEventListener('click', function () {
  if (body.classList.contains('dark-mode')) {
    localStorage.removeItem('mode', 'dark');
    toggle.innerHTML = '다크모드로 🌙';
    body.classList.remove('dark-mode');

    navIcons[0].src="/feed.png"
    navIcons[1].src="/edit.png"
    navIcons[2].src="/chat.png"

  } else {
    localStorage.setItem('mode', 'dark');
    toggle.innerHTML = '일반모드로 ☀️';
    body.classList.remove('grey-bg');
    body.classList.add('dark-mode');

    navIcons[0].src="/feed2.png"
    navIcons[1].src="/edit2.png"
    navIcons[2].src="/chat2.png"
  }
});
</script>
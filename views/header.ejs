<div class="header">
  <div>
    <a href="/" class="headerLeft"
      ><img src="/homelogo.png" class="headerLogo" /><span
        class="headerServiceName"
        >Dboard</span
      ></a
    >
  </div>

  <% if(currentUser) { %>
  <div class="headerProfileBox">
    <a class="headerToggle">ë‹¤í¬ëª¨ë“œë¡œ ğŸŒ™</a>
    <a href="/chat/list">ì±„íŒ…</a>
    <button class="headerProfileInner">
      <% if(currentUser.img) { %>
      <p><%= currentUser.username %></p>
      <div class="headerProfile">
        <img src="<%= currentUser.img %>" class="headerUserProfile" />
      </div>
      <% } else { %>
      <p><%= currentUser.username %></p>
      <div class="headerProfile">
        <img class="headerUserProfile" src="/profile.png" />
      </div>
      <% } %>
    </button>

    <ul class="userDropdown">
      <li><a href="/mypage">ë§ˆì´í˜ì´ì§€</a></li>
      <li><a href="/mypost">ì‘ì„±í•œ ê¸€</a></li>
      <li><a href="/logout">ë¡œê·¸ì•„ì›ƒ</a></li>
    </ul>
  </div>

  <% } else { %>
  <div class="headerProfileBox">
    <button class="headerToggle">ë‹¤í¬ëª¨ë“œë¡œ ğŸŒ™</button>
    <a href="/login" class="headerLoginRegister"><div>ë¡œê·¸ì¸</div></a>
    <a href="/register" class="headerLoginRegister"><div>íšŒì›ê°€ì…</div></a>
  </div>
  <% } %>
</div>

<script>
  // ìœ ì € ë“œë¡­ë‹¤ìš´ í† ê¸€
  let dropdown = document.querySelector('.userDropdown');
  let profile = document.querySelector('.headerProfileInner');

  if (profile) {
    profile.addEventListener('click', () => {
      dropdown.classList.toggle('active');
    });
  }
</script>

<script>
  // ë‹¤í¬ëª¨ë“œ ê´€ë ¨
  let mode = localStorage.getItem('mode');
  let toggle = document.querySelector('.headerToggle');
  let body = document.querySelector('body');
  let headerIcons = document.querySelectorAll('.headerIcon');

  // í™”ë©´ ì´ë™ì‹œì—ë„ ë‹¤í¬ëª¨ë“œ ìœ ì§€
  if (mode === 'dark') {
    toggle.innerHTML = 'ì¼ë°˜ëª¨ë“œë¡œ â˜€ï¸';
    body.classList.remove('lightLayout');
    body.classList.add('dark-mode');
  } else {
    toggle.innerHTML = 'ë‹¤í¬ëª¨ë“œë¡œ ğŸŒ™';
    body.classList.remove('dark-mode');
  }

  // ë‹¤í¬ëª¨ë“œ ë²„íŠ¼ ëˆŒë €ì„ ë•Œ
  toggle.addEventListener('click', function () {
    if (body.classList.contains('dark-mode')) {
      localStorage.removeItem('mode', 'dark');
      toggle.innerHTML = 'ë‹¤í¬ëª¨ë“œë¡œ ğŸŒ™';
      body.classList.remove('dark-mode');
      body.classList.add('lightLayout');
    } else {
      localStorage.setItem('mode', 'dark');
      toggle.innerHTML = 'ì¼ë°˜ëª¨ë“œë¡œ â˜€ï¸';
      body.classList.remove('lightLayout');
      body.classList.add('dark-mode');
    }
  });
</script>
